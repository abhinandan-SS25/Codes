qt()?
qnorm?
qnorm()?
help()
?qnorm()
qt
?qt()
?dt()
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -1, 1)
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -1, 1) +
geom_norm_density()
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4) +
geom_norm_density()
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue")
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_line(aes(y = normal_density, color = "Normal"), size = 1.2) +
geom_line(aes(y = t_density, color = "t"), size = 1.2, linetype = "dashed")
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_line(aes(y = q1, color = "Normal"), size = 1.2) +
geom_line(aes(y = q2, color = "t"), size = 1.2, linetype = "dashed")
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_line(aes(x = q1, color = "Normal"), size = 1.2) +
geom_line(aes(x = q2, color = "t"), size = 1.2, linetype = "dashed")
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_vline(aes(x = q1, color = "Normal"), size = 1.2) +
geom_vline(aes(x = q2, color = "t"), size = 1.2, linetype = "dashed")
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_vline(xintercept = q1, color = "blue", linetype="dashed") +
geom_vline(xintercept = q2, color = "blue", linetype="dashed")
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_vline(xintercept = q1, color = "blue", linetype="dashed") +
geom_vline(xintercept = q2, color = "red", linetype="dashed")
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_vline(xintercept = q1, color = "blue", linetype="dashed") +
geom_vline(xintercept = q2, color = "red", linetype="dashed") +
geom_norm_fill(0,1, a = qnorm(0.025), b = qnorm(0.975))
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_vline(xintercept = q1, color = "blue", linetype="dashed") +
geom_vline(xintercept = q2, color = "red", linetype="dashed") +
geom_norm_fill(0,1, b = qnorm(0.025), alpha=0.5, color="blue")
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_vline(xintercept = q1, color = "blue", linetype="dashed") +
geom_vline(xintercept = q2, color = "red", linetype="dashed") +
geom_norm_fill(0,1, b = qnorm(0.025), alpha=0.5, fill="blue")
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_vline(xintercept = q1, color = "blue", linetype="dashed") +
geom_vline(xintercept = q2, color = "red", linetype="dashed") +
geom_norm_fill(0,1, b = qnorm(0.025), alpha=0.5, fill="blue") +
geom_norm_fill(0,1, a = qnorm(0.975), alpha=0.5, fill="blue")
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_vline(xintercept = q1, color = "blue", linetype="dashed") +
geom_vline(xintercept = q2, color = "red", linetype="dashed") +
geom_norm_fill(0,1, b = qnorm(0.025), alpha=0.5, fill="blue") +
geom_norm_fill(0,1, a = qnorm(0.975), alpha=0.5, fill="blue") +
geom_t_fill(19, b = qnorm(0.025), alpha=0.5, fill="red") +
geom_t_fill(0,1, a = qnorm(0.975), alpha=0.5, fill="red"))
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_vline(xintercept = q1, color = "blue", linetype="dashed") +
geom_vline(xintercept = q2, color = "red", linetype="dashed") +
geom_norm_fill(0,1, b = qnorm(0.025), alpha=0.5, fill="blue") +
geom_norm_fill(0,1, a = qnorm(0.975), alpha=0.5, fill="blue") +
geom_t_fill(19, b = qnorm(0.025), alpha=0.5, fill="red") +
geom_t_fill(0,1, a = qnorm(0.975), alpha=0.5, fill="red")
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_vline(xintercept = q1, color = "blue", linetype="dashed") +
geom_vline(xintercept = q2, color = "red", linetype="dashed") +
geom_norm_fill(0,1, b = qnorm(0.025), alpha=0.5, fill="blue") +
geom_norm_fill(0,1, a = qnorm(0.975), alpha=0.5, fill="blue") +
geom_t_fill(19, b = qnorm(0.025), alpha=0.5, fill="red") +
geom_t_fill(19, a = qnorm(0.975), alpha=0.5, fill="red")
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_vline(xintercept = q1, color = "blue", linetype="dashed") +
geom_vline(xintercept = q2, color = "red", linetype="dashed") +
geom_norm_fill(0,1, b = qnorm(0.025), alpha=0.5, fill="blue") +
geom_norm_fill(0,1, a = qnorm(0.975), alpha=0.5, fill="blue") +
geom_t_fill(19, b = qt(0.025), alpha=0.5, fill="red") +
geom_t_fill(19, a = qt(0.975), alpha=0.5, fill="red")
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_vline(xintercept = q1, color = "blue", linetype="dashed") +
geom_vline(xintercept = q2, color = "red", linetype="dashed") +
geom_norm_fill(0,1, b = qnorm(0.025), alpha=0.5, fill="blue") +
geom_norm_fill(0,1, a = qnorm(0.975), alpha=0.5, fill="blue") +
geom_t_fill(19, b = qt(0.025, df=19), alpha=0.5, fill="red") +
geom_t_fill(19, a = qt(0.975, df=19), alpha=0.5, fill="red")
ci = x_bar + c(-1,1)*dt(0.975, df=19)*s
t.test(weather_dates_f)
ci = x_bar + c(-1,1)*q2*s
ci = x_bar + c(-1,1)*q2*s
ci = x_bar + c(-1,1)*q1*s
ci = x_bar + c(-1,1)*qt(0.975, df=19)*s
ci = x_bar + c(-1,1)*qt(0.975, df=19)*s
ci = x_bar + c(-1,1)*qt(0.975, df=19)*(s/sqrt(n))
t.test(weather_dates_f)
weather_dates_d = weather %>%
mutate(Date = ymd(date), day = day(Date), month=month(Date), year = year(Date)) %>%
filter(day = 14, month = 4, year >= 2003) %>%
pul(tmax)
weather_dates_d = weather %>%
mutate(Date = ymd(date), day = day(Date), month=month(Date), year = year(Date)) %>%
filter(day = 14, month = 4, year >= 2003) %>%
pull(tmax)
weather_dates_d = weather %>%
mutate(Date = ymd(date), day = day(Date), month=month(Date), year = year(Date)) %>%
filter(day == 14 & month == 4 & year >= 2003) %>%
pull(tmax)
weather_dates_d = weather %>%
mutate(Date = ymd(date), day = day(Date), month=month(Date), year = year(Date)) %>%
filter(day == 14 & month == 4 & year >= 2003)
View(weather_dates_d)
weather_dates_d = weather %>%
mutate(Date = ymd(date), day = day(Date), month=month(Date), year = year(Date)) %>%
filter(day == 14 & month == 4 & year >= 2003) %>%
pull(tmax)
weather_dates_d = weather %>%
mutate(Date = ymd(date), day = day(Date), month=month(Date), year = year(Date)) %>%
filter(day == 14 & month == 4 & year >= 2003) %>%
pull(tmax)
n_d = length(weather_dates_d)
sd_d = sd(weather_dates_d)
weather_dates_d = weather %>%
mutate(Date = ymd(date), day = day(Date), month=month(Date), year = year(Date)) %>%
filter(day == 14 & month == 4 & year >= 2003) %>%
pull(tmax)
n_d = length(weather_dates_d)
sd_d = sd(weather_dates_d)
x_d = mean(weather_dates_d)
t = (x_d-55.6)/(sd_d/sqrt(n_d))
weather_dates_d = weather %>%
mutate(Date = ymd(date), day = day(Date), month=month(Date), year = year(Date)) %>%
filter(day == 14 & month == 4 & year >= 2003) %>%
pull(tmax)
n_d = length(weather_dates_d)
sd_d = sd(weather_dates_d)
x_d = mean(weather_dates_d)
t = (x_d-55.6)/(sd_d/sqrt(n_d))
pt(t, n_d-1)
snow = weather %>%
mutate(Date = ymd(date), day = day(Date), month=month(Date), year = year(Date), days_after_31 = yday(Date)) %>%
filter(month >= 1 & month <= 6 & ((year >= 1903 & year <=1922) | (year >= 2003 & year <= 2022)))
View(snow)
snow = weather %>%
mutate(Date = ymd(date), day = day(Date), month=month(Date), year = year(Date), days_after_31 = yday(Date)) %>%
filter(month >= 1 & month <= 6 & ((year >= 1903 & year <=1922) | (year >= 2003 & year <= 2022)) & snow > 0)
snow = snow %>%
mutate(period = ifelse(year <= 1922, "early 1900s", "early 2000s"))
View(snow)
snow_1900 = snow %>%
filter(period == "early 1900s")
snow_2000 = snow %>%
filter(period == "early 2000s")
View(snow_1900)
x_1900 = mean(snow_1900)
snow_1900 = snow %>%
filter(period == "early 1900s") %>%
pull(snow)
snow_2000 = snow %>%
filter(period == "early 2000s") %>%
pull(snow)
n_1900 = length(snow_1900)
x_1900 = mean(snow_1900)
sd_1900 = sd(snow_1900)
n_2000 = length(snow_2000)
x_2000 = mean(snow_2000)
sd_2000 = sd(snow_2000)
snow_1900 = snow %>%
filter(period == "early 1900s")
snow_2000 = snow %>%
filter(period == "early 2000s")
n_1900 = length(snow_1900 %>%
pull(snow))
x_1900 = mean(snow_1900 %>%
pull(snow))
sd_1900 = sd(snow_1900 %>%
pull(snow))
n_2000 = length(snow_2000 %>%
pull(snow))
x_2000 = mean(snow_2000 %>%
pull(snow))
sd_2000 = sd(snow_2000 %>%
pull(snow))
snow_1900 = snow %>%
filter(period == "early 1900s") %>%
pull(snow)
snow_2000 = snow %>%
filter(period == "early 2000s") %>%
pull(snow)
n_1900 = length(snow_1900)
x_1900 = mean(snow_1900)
sd_1900 = sd(snow_1900)
n_2000 = length(snow_2000)
x_2000 = mean(snow_2000)
sd_2000 = sd(snow_2000)
snow_1900 = snow %>%
filter(period == "early 1900s")
snow_2000 = snow %>%
filter(period == "early 2000s")
n_1900 = length(snow_1900 %>%
pull(snow))
x_1900 = mean(snow_1900 %>%
pull(snow))
sd_1900 = sd(snow_1900 %>%
pull(snow))
n_2000 = length(snow_2000 %>%
pull(snow))
x_2000 = mean(snow_2000 %>%
pull(snow))
sd_2000 = sd(snow_2000 %>%
pull(snow))
ggplot(snow_1900, aes(x=snow)) +
geom_density() +
geom_density(data=snow_2000, aes(x=snow))
ggplot(snow_1900, aes(x=snow)) +
geom_density(color="red") +
geom_density(data=snow_2000, aes(x=snow), color="blue")
snow = weather %>%
mutate(Date = ymd(date), day = day(Date), month=month(Date), year = year(Date), days_after_31 = yday(Date)) %>%
filter(month >= 1 & month <= 6 & ((year >= 1903 & year <=1922) | (year >= 2003 & year <= 2022)) & snow > 0) %>%
group_by(month, year) %>%
summarise(latest_snow_date = max(yday)) %>%
ungroup()
snow = weather %>%
mutate(Date = ymd(date), day = day(Date), month=month(Date), year = year(Date), days_after_31 = yday(Date)) %>%
filter(month >= 1 & month <= 6 & ((year >= 1903 & year <=1922) | (year >= 2003 & year <= 2022)) & snow > 0) %>%
group_by(month, year) %>%
summarise(latest_snow_date = max(days_after_31)) %>%
ungroup()
snow = snow %>%
mutate(period = ifelse(year <= 1922, "early 1900s", "early 2000s"))
View(snow)
snow_1900 = snow %>%
filter(period == "early 1900s")
snow_2000 = snow %>%
filter(period == "early 2000s")
n_1900 = length(snow_1900 %>%
pull(snow))
snow = weather %>%
mutate(Date = ymd(date), day = day(Date), month=month(Date), year = year(Date), days_after_31 = yday(Date)) %>%
filter(month >= 1 & month <= 6 & ((year >= 1903 & year <=1922) | (year >= 2003 & year <= 2022)) & snow > 0) %>%
group_by(year, month) %>%
filter(days_after_31 = max(days_after_31))
snow = weather %>%
mutate(Date = ymd(date), day = day(Date), month=month(Date), year = year(Date), days_after_31 = yday(Date)) %>%
filter(month >= 1 & month <= 6 & ((year >= 1903 & year <=1922) | (year >= 2003 & year <= 2022)) & snow > 0) %>%
group_by(year, month) %>%
filter(days_after_31 == max(days_after_31))
snow = snow %>%
mutate(period = ifelse(year <= 1922, "early 1900s", "early 2000s"))
View(snow)
snow_1900 = snow %>%
filter(period == "early 1900s")
snow_2000 = snow %>%
filter(period == "early 2000s")
n_1900 = length(snow_1900 %>%
pull(snow))
x_1900 = mean(snow_1900 %>%
pull(snow))
sd_1900 = sd(snow_1900 %>%
pull(snow))
n_2000 = length(snow_2000 %>%
pull(snow))
x_2000 = mean(snow_2000 %>%
pull(snow))
sd_2000 = sd(snow_2000 %>%
pull(snow))
ggplot(snow_1900, aes(x=snow)) +
geom_density(color="red") +
geom_density(data=snow_2000, aes(x=snow), color="blue")
t.test(x=snow_1900, y=snow_2000)
t.test(x=snow_1900$snow, y=snow_2000$snow)
snow_1900 = snow %>%
filter(period == "early 1900s")
snow_2000 = snow %>%
filter(period == "early 2000s")
n_1900 = length(snow_1900 %>%
pull(Date))
x_1900 = mean(snow_1900 %>%
pull(Date))
sd_1900 = sd(snow_1900 %>%
pull(Date))
n_2000 = length(snow_2000 %>%
pull(Date))
x_2000 = mean(snow_2000 %>%
pull(Date))
sd_2000 = sd(snow_2000 %>%
pull(Date))
ggplot(snow_1900, aes(x=Date)) +
geom_density(color="red") +
geom_density(data=snow_2000, aes(x=date), color="blue")
ggplot(snow_1900, aes(x=Date)) +
geom_density(color="red") +
geom_density(data=snow_2000, aes(x=Date), color="blue")
t.test(x=snow_1900$Date, y=snow_2000$Date)
snow_1900 = snow %>%
filter(period == "early 1900s")
snow_2000 = snow %>%
filter(period == "early 2000s")
n_1900 = length(snow_1900 %>%
pull(days_after_31))
x_1900 = mean(snow_1900 %>%
pull(days_after_31))
sd_1900 = sd(snow_1900 %>%
pull(days_after_31))
n_2000 = length(snow_2000 %>%
pull(days_after_31))
x_2000 = mean(snow_2000 %>%
pull(days_after_31))
sd_2000 = sd(snow_2000 %>%
pull(days_after_31))
ggplot(snow_1900, aes(x=days_after_31)) +
geom_density(color="red") +
geom_density(data=snow_2000, aes(x=days_after_31), color="blue")
t.test(x=snow_1900$days_after_31, y=snow_2000$days_after_31)
t.test(x=snow_1900$days_after_31, y=snow_2000$days_after_31)$p.value
marathon = read.csv("../../data/boston-marathon-data.csv")
View(marathon)
marathon = read.csv("../../data/boston-marathon-data.csv") %>%
filter(Age_Range == "35-39)
View(marathon)
marathon = read.csv("../../data/boston-marathon-data.csv") %>%
marathon = read.csv("../../data/boston-marathon-data.csv") %>%
filter(Age_Range == "35-39")
View(marathon)
View(marathon)
marathon = read.csv("../../data/boston-marathon-data.csv") %>%
filter(Age_Range == "35-39", Year == 2010)
marathon = read.csv("../../data/boston-marathon-data.csv") %>%
filter(Age_Range == "35-39", Year == 2010)
n_m = length(marathon)
n_m
x_m = mean(marathon)
x_m
s_m = sd(marathon)
marathon = read.csv("../../data/boston-marathon-data.csv") %>%
filter(Age_Range == "35-39", Year == 2010) %>%
pull(Time)
n_m = length(marathon)
n_m
x_m = mean(marathon)
x_m
s_m = sd(marathon)
s_m
q_m = quantile(marathon, c(0.10, 0.25, 0.50, 0.75, 0.90))
marathon = read.csv("../../data/boston-marathon-data.csv") %>%
filter(Age_Range == "35-39", Year == 2010) %>%
pull(Time)
n_m = length(marathon)
n_m
x_m = mean(marathon)
x_m
s_m = sd(marathon)
s_m
q_m = quantile(marathon, c(0.10, 0.25, 0.50, 0.75, 0.90))
q_m
ggplot(marathon) +
geom_density(color="red")
marathon = read.csv("../../data/boston-marathon-data.csv") %>%
filter(Age_Range == "35-39", Year == 2010)
n_m = length(marathon %>%
pull(Time))
n_m
x_m = mean(marathon %>%
pull(Time))
x_m
s_m = sd(marathon %>%
pull(Time))
s_m
q_m = quantile(marathon %>%
pull(Time), c(0.10, 0.25, 0.50, 0.75, 0.90))
q_m
ggplot(marathon, aes(x=Time)) +
geom_density(color="red")
ci_m = x_m + c(-1,1)*qt(0.975, df=n_m-1)*(s/sqrt(n_m))
ci_m = x_m + c(-1,1)*qt(0.975, df=n_m-1)*(s/sqrt(n_m))
ci_m
t.test(marathon$Time)
weather = read.csv("../../data/madison-weather-official-1869-2022.csv")
weather_dates = weather %>%
mutate(Date = ymd(date), day = day(Date), month=month(Date), year = year(Date)) %>%
filter(day == 14 & month == 4 & year >= 2003 & year <= 2022)
weather_dates_f = weather_dates %>%
pull(tmax)
n = length(weather_dates_f)
x_bar = mean(weather_dates_f)
s = sd(weather_dates_f)
ggplot(weather_dates, aes(x=tmax)) +
geom_density()
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_vline(xintercept = q1, color = "blue", linetype="dashed") +
geom_vline(xintercept = q2, color = "red", linetype="dashed") +
geom_norm_fill(0,1, b = qnorm(0.025), alpha=0.5, fill="blue") +
geom_norm_fill(0,1, a = qnorm(0.975), alpha=0.5, fill="blue") +
geom_t_fill(19, b = qt(0.025, df=19), alpha=0.5, fill="red") +
geom_t_fill(19, a = qt(0.975, df=19), alpha=0.5, fill="red")
ci = x_bar + c(-1,1)*qt(0.975, df=19)*(s/sqrt(n))
t.test(weather_dates_f)
q1 = qnorm(0.975)
q2 = qt(0.975, df=19)
gt(19, -4, 4, color="red") +
geom_norm_density(color="blue") +
geom_vline(xintercept = q1, color = "blue", linetype="dashed") +
geom_vline(xintercept = q2, color = "red", linetype="dashed") +
geom_norm_fill(0,1, b = qnorm(0.025), alpha=0.5, fill="blue") +
geom_norm_fill(0,1, a = qnorm(0.975), alpha=0.5, fill="blue") +
geom_t_fill(19, b = qt(0.025, df=19), alpha=0.5, fill="red") +
geom_t_fill(19, a = qt(0.975, df=19), alpha=0.5, fill="red")
marathon_10 = read.csv("../../data/boston-marathon-data.csv") %>%
filter(Age_Range == "35-39", Year == 2010)
marathon_11 = read.csv("../../data/boston-marathon-data.csv") %>%
filter(Age_Range == "35-39", Year == 2011)
marathon_10 = read.csv("../../data/boston-marathon-data.csv") %>%
filter(Age_Range == "35-39", Year == 2010)
marathon_11 = read.csv("../../data/boston-marathon-data.csv") %>%
filter(Age_Range == "35-39", Year == 2011)
n_m_10 = length(marathon_10 %>%
pull(Time))
n_m_11 = length(marathon_11 %>%
pull(Time))
x_m_10 = mean(marathon_10 %>%
pull(Time))
x_m_11 = mean(marathon_11 %>%
pull(Time))
s_m_10 = sd(marathon_10 %>%
pull(Time))
s_m_10 = sd(marathon_11 %>%
pull(Time))
t = (x_m_10-x_m_11)/sqrt((s_m_10^2/n_m_10)+(s_m_11^2/n_m_11)))
t = (x_m_10-x_m_11)/sqrt((s_m_10^2/n_m_10)+(s_m_11^2/n_m_11))
marathon_10 = read.csv("../../data/boston-marathon-data.csv") %>%
filter(Age_Range == "35-39", Year == 2010)
marathon_11 = read.csv("../../data/boston-marathon-data.csv") %>%
filter(Age_Range == "35-39", Year == 2011)
n_m_10 = length(marathon_10 %>%
pull(Time))
n_m_11 = length(marathon_11 %>%
pull(Time))
x_m_10 = mean(marathon_10 %>%
pull(Time))
x_m_11 = mean(marathon_11 %>%
pull(Time))
s_m_10 = sd(marathon_10 %>%
pull(Time))
s_m_11 = sd(marathon_11 %>%
pull(Time))
t = (x_m_10-x_m_11)/sqrt((s_m_10^2/n_m_10)+(s_m_11^2/n_m_11))
t
t_m = (x_m_10-x_m_11)/sqrt((s_m_10^2/n_m_10)+(s_m_11^2/n_m_11))
t_m
t.test(x=marathon_10$Time, y=marathon_11$Time)
dof = (s_m_10^2/n_m_10 + s_m_11^2/n_m_11)^2 / (s_m_10^4/(n_m_10^2*(n_m_10-1)) + s_m_11^4/(n_m_11^2*(n_m_11-1)))
dof
pt(t_m, n_d-1)
2*pt(-abs(t_m), dof)
t.test(x=snow_1900$days_after_31, y=snow_2000$days_after_31)$p.value
t.test(x=snow_1900$days_after_31, y=snow_2000$days_after_31)$p.value
t.test(marathon$Time)
