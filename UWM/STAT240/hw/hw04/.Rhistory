mutate(passengers_year = sum(passenger))
## data summary
prob5 = prob5 %>%
group_by(day, month, year) %>%
summarize(daily_average = mean(passenger)) %>%
arrange(month)
## plot the table
ggplot(prob5, aes(y=daily_average, x=month)) +
geom_col() +
facet_wrap(vars(year))
scale_y_continuous(label = scales::comma) +
xlab("Daily ")
prob5 = ord_modified %>%
group_by(year) %>%
mutate(passengers_year = sum(passenger))
## data summary
prob5 = prob5 %>%
group_by(day, month, year) %>%
summarize(daily_average = mean(passenger)) %>%
arrange(month)
## plot the table
ggplot(prob5, aes(y=daily_average, x=month)) +
geom_col() +
facet_wrap(vars(year))
scale_y_continuous(label = comma) +
xlab("Daily Average") +
ylab("Month")
prob5 = ord_modified %>%
group_by(year) %>%
mutate(passengers_year = sum(passenger))
## data summary
prob5 = prob5 %>%
group_by(day, month, year) %>%
summarize(daily_average = mean(passenger)) %>%
arrange(month)
## plot the table
ggplot(prob5, aes(y=daily_average, x=month)) +
geom_col() +
facet_wrap(vars(year))
scale_y_continuous(labels = comma) +
xlab("Daily Average") +
ylab("Month")
prob5 = ord_modified %>%
group_by(year) %>%
mutate(passengers_year = sum(passenger))
## data summary
prob5 = prob5 %>%
group_by(day, month, year) %>%
summarize(daily_average = mean(passenger)) %>%
arrange(month)
## plot the table
ggplot(prob5, aes(y=daily_average, x=month)) +
geom_col() +
facet_wrap(vars(year)) +
scale_y_continuous(labels = comma) +
xlab("Daily Average") +
ylab("Month")
prob5 = ord_modified %>%
group_by(year) %>%
mutate(passengers_year = sum(passenger))
## data summary
prob5 = prob5 %>%
group_by(day, month, year) %>%
summarize(daily_average = mean(passenger)) %>%
arrange(month)
## plot the table
ggplot(prob5, aes(y=daily_average, x=month)) +
geom_col() +
facet_wrap(vars(year)) +
scale_y_continuous(label = scales::comma) +
xlab("Daily Average") +
ylab("Month")
prob5 = ord_modified %>%
group_by(year) %>%
mutate(passengers_year = sum(passenger))
## data summary
prob5 = prob5 %>%
group_by(month, year) %>%
summarize(daily_average = sum(mean(passenger))) %>%
arrange(month)
## plot the table
ggplot(prob5, aes(y=daily_average, x=month)) +
geom_col() +
facet_wrap(vars(year)) +
scale_y_continuous(label = scales::comma) +
xlab("MOnth") +
ylab("Daily Average")
prob5 = ord_modified %>%
group_by(year) %>%
mutate(passengers_year = sum(passenger))
## data summary
prob5 = prob5 %>%
group_by(month, year) %>%
summarize(daily_average = sum(mean(passenger))) %>%
arrange(month)
## plot the table
ggplot(prob5, aes(y=daily_average, x=factor(month, levels =c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")))) +
geom_col() +
facet_wrap(vars(year)) +
scale_y_continuous(label = scales::comma) +
xlab("MOnth") +
ylab("Daily Average")
## data summary
prob5 = prob5 %>%
group_by(month, year) %>%
summarize(daily_average = sum(mean(passenger))) %>%
arrange(month)
## data summary
prob5 = prob5 %>%
group_by(month, year) %>%
summarize(daily_average = sum(mean(passengers))) %>%
arrange(month)
prob5 = ord_modified %>%
group_by(year) %>%
mutate(passengers_year = sum(passenger))
## data summary
prob5 = prob5 %>%
group_by(month, year) %>%
summarize(daily_average = sum(mean(passenger))) %>%
arrange(month)
## plot the table
ggplot(prob5, aes(y=daily_average, x=factor(month, levels =c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")))) +
geom_col() +
facet_wrap(vars(year)) +
scale_y_continuous(label = scales::comma) +
xlab("MOnth") +
ylab("Daily Average")
prob5 = ord_modified %>%
group_by(month, year) %>%
mutate(passengers_year = sum(passenger))
## data summary
prob5 = prob5 %>%
group_by(day, month, year) %>%
summarize(daily_average = mean(passenger)) %>%
arrange(month)
## plot the table
ggplot(prob5, aes(y=daily_average, x=factor(month, levels =c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")))) +
geom_col() +
facet_wrap(vars(year)) +
scale_y_continuous(label = scales::comma) +
xlab("MOnth") +
ylab("Daily Average")
prob5 = ord_modified %>%
group_by(day, month, year) %>%
summarize(daily_total = sum(passenger))
## data summary
## plot the table
ggplot(prob5, aes(y=daily_average, x=factor(month, levels =c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")))) +
geom_col() +
facet_wrap(vars(year)) +
scale_y_continuous(label = scales::comma) +
xlab("MOnth") +
ylab("Daily Average")
View(prob5)
prob5 = ord_modified %>%
group_by(day, month, year) %>%
summarize(daily_total = sum(passenger))
## data summary
prob5 = prob5 %>%
group_by(month, year) %>%
summarize(n = n()) %>%
arrange(month)
## plot the table
ggplot(prob5, aes(y=daily_average, x=factor(month, levels =c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")))) +
geom_col() +
facet_wrap(vars(year)) +
scale_y_continuous(label = scales::comma) +
xlab("MOnth") +
ylab("Daily Average")
prob5 = ord_modified %>%
group_by(day, month, year) %>%
summarize(daily_total = sum(passenger))
## data summary
prob5 = prob5 %>%
group_by(month, year) %>%
summarize(days = n(), total_month = sum(passenger), average = total_month / days) %>%
arrange(month)
prob5 = ord_modified %>%
group_by(day, month, year) %>%
summarize(daily_total = sum(passenger))
## data summary
prob5 = prob5 %>%
group_by(month, year) %>%
summarize(days = n(), total_month = sum(passenger), average = total_month / days) %>%
arrange(month)
prob5 = ord_modified %>%
group_by(day, month, year) %>%
summarize(daily_total = sum(passenger))
## data summary
prob5 = prob5 %>%
group_by(month, year) %>%
summarize(days = n(), total_month = sum(daily_total), average = total_month / days) %>%
arrange(month)
## plot the table
ggplot(prob5, aes(y=average, x=factor(month, levels =c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")))) +
geom_col() +
facet_wrap(vars(year)) +
scale_y_continuous(label = scales::comma) +
xlab("MOnth") +
ylab("Daily Average")
prob6 = ord_modified %>%
filter(year>=2017 & year<=2019)
View(prob6)
prob6 = ord_modified %>%
filter(year>=2017 & year<=2019) %>%
group_by(date, wday) %>%
summarize(total = sum(passengers)) %>%
group_by(wday) %>%
summarize(n=n(), total = sum(total), average = total/n)%>%
arrange(desc(average))
prob6 = ord_modified %>%
filter(year>=2017 & year<=2019) %>%
group_by(date, wday) %>%
summarize(total = sum(passenger)) %>%
group_by(wday) %>%
summarize(n=n(), total = sum(total), average = total/n)%>%
arrange(desc(average))
prob6
prob6 = ord_modified %>%
filter(year>=2017 & year<=2019) %>%
group_by(date, wday) %>%
summarize(total = sum(passenger)) %>%
group_by(wday) %>%
summarize(n=n(), total = sum(total), average = total/n) %>%
arrange(desc(average))
prob7 = ord_modified %>%
filter(year>=2017 & year<=2019) %>%
group_by(wday) %>%
summarize(average(mean(passenger))) %>%
arrange(desc(average))
prob6 = ord_modified %>%
filter(year>=2017 & year<=2019) %>%
group_by(date, wday) %>%
summarize(total = sum(passenger)) %>%
group_by(wday) %>%
summarize(n=n(), total = sum(total), average = total/n) %>%
arrange(desc(average))
prob7 = ord_modified %>%
filter(year>=2017 & year<=2019) %>%
group_by(wday) %>%
summarize(average=(mean(passenger))) %>%
arrange(desc(average))
prob7
prob6
highest_dates = ord_modified %>%
group_by(date) %>%
summarize(total = sum(passenger)) %>%
arrange(desc(total)) %>%
slice_max(n=20)
highest_dates = ord_modified %>%
group_by(date) %>%
summarize(total = sum(passenger)) %>%
arrange(desc(total))
View(highest_dates)
highest_dates = ord_modified %>%
group_by(date) %>%
summarize(total = sum(passenger)) %>%
arrange(desc(total)) %>%
head(20)
highest_dates = ord_modified %>%
group_by(date) %>%
summarize(total = sum(passenger)) %>%
arrange(desc(total)) %>%
head(20)
highest_dates[, wday]
highest_dates = ord_modified %>%
group_by(date) %>%
summarize(total = sum(passenger)) %>%
arrange(desc(total)) %>%
head(20)
highest_dates[, "wday"]
highest_dates = ord_modified %>%
group_by(date) %>%
summarize(total = sum(passenger)) %>%
arrange(desc(total)) %>%
head(20)
wday(highest_dates[, date])
highest_dates = ord_cleaned %>%
group_by(date) %>%
summarize(total = sum(passenger)) %>%
arrange(desc(total)) %>%
head(20)
highest_dates = ord_cleaned %>%
group_by(date) %>%
summarize(total = sum(passengers)) %>%
arrange(desc(total)) %>%
head(20)
wday(highest_dates[, date])
highest_dates = ord_cleaned %>%
group_by(date) %>%
summarize(total = sum(passengers)) %>%
arrange(desc(total)) %>%
head(20)
wday(highest_dates[, "date"])
highest_dates = ord_modified %>%
group_by(date) %>%
summarize(total = sum(passenger)) %>%
arrange(desc(total)) %>%
head(20)
highest_dates[, date]
highest_dates = ord_modified %>%
group_by(date) %>%
summarize(total = sum(passenger)) %>%
arrange(desc(total)) %>%
head(20)
highest_dates %>%
mutate(date = ymd(date), weekday = wday(date))
prob6 = ord_modified %>%
filter(year>=2017 & year<=2019) %>%
group_by(date, wday) %>%
summarize(total = sum(passenger)) %>%
group_by(wday) %>%
summarize(n=n(), total = sum(total), average = total/n) %>%
arrange(desc(average))
prob6
highest_dates = ord_modified %>%
group_by(date) %>%
summarize(total = sum(passenger)) %>%
arrange(desc(total)) %>%
head(20)
highest_dates %>%
mutate(date = ymd(date), weekday = wday(date, labels=TRUE))
highest_dates = ord_modified %>%
group_by(date) %>%
summarize(total = sum(passenger)) %>%
arrange(desc(total)) %>%
head(20)
highest_dates %>%
mutate(date = ymd(date), weekday = wday(date, label=TRUE))
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE,
error = TRUE, fig.height = 3)
library(tidyverse)
library(lubridate)
source("../../scripts/viridis.R")
ord = map_dfr(2017:2021, ~{
return ( read_csv(str_c("../../data/ORD-", .x, ".csv")) )
})
ord_cleaned = ord %>%
mutate(date = ymd(date),
year = year(date),
month = as.character(month(date, label=TRUE)),
day = day(date),
wday = as.character(wday(date, label=TRUE))) %>%
relocate(airport, date, year, month, day, wday) %>%
select(-terminal) %>%
rename(passengers = all_total, flights = all_flights, booths = all_booths) %>%
arrange(date, hour)
ord_cleaned %>% print(n=5, c=everything())
dim(ord_cleaned)
count_na = function(column) {
return (sum(is.na(column)))
}
all_days = data.frame(Dates_all =
seq(ymd("2017-01-01"), ymd("2021-12-31"), by="days"))
ord_dates_na = ord_cleaned %>%
summarize(missing_dates_count = across(c(date, year, month, day, wday), count_na))
ord_dates_na
missing_dates = all_days %>%
filter(!all_days$Dates_all %in% ord_cleaned$date)
missing_dates
ord_modified = ord_cleaned %>%
mutate(time_of_day = case_when(
(hour >= "0000 - 0100" & hour <= "0300 - 0400") ~ "overnight",
(hour >= "0400 - 0500" & hour <= "0700 - 0800") ~ "early morning",
(hour >= "0800 - 0900" & hour <= "1100 - 1200") ~ "morning",
(hour >= "1200 - 1300" & hour <= "1500 - 1600") ~ "afternoon",
(hour >= "1600 - 1700" & hour <= "1900 - 2000") ~ "early evening",
(hour >= "2000 - 2100" & hour <= "2300 - 0000") ~ "late evening"
))
ord_modified = ord_modified %>%
mutate(time_of_day =
fct_relevel(time_of_day,
c("overnight", "early morning", "morning", "afternoon", "early evening", "late evening")))
ord = ord %>%
mutate(date = ymd(date),
year = year(date),
month = as.character(month(date, label=TRUE)),
day = day(date),
wday = as.character(wday(date, label=TRUE))) %>%
relocate(airport, date, year, month, day, wday) %>%
select(-terminal) %>%
rename(passengers = all_total, flights = all_flights, booths = all_booths) %>%
arrange(date, hour)
ord %>% print(n=5, c=everything())
dim(ord)
count_na = function(column) {
return (sum(is.na(column)))
}
all_days = data.frame(Dates_all =
seq(ymd("2017-01-01"), ymd("2021-12-31"), by="days"))
ord_dates_na = ord %>%
summarize(missing_dates_count = across(c(date, year, month, day, wday), count_na))
ord_dates_na
missing_dates = all_days %>%
filter(!all_days$Dates_all %in% ord$date)
missing_dates
ord = ord %>%
mutate(time_of_day = case_when(
(hour >= "0000 - 0100" & hour <= "0300 - 0400") ~ "overnight",
(hour >= "0400 - 0500" & hour <= "0700 - 0800") ~ "early morning",
(hour >= "0800 - 0900" & hour <= "1100 - 1200") ~ "morning",
(hour >= "1200 - 1300" & hour <= "1500 - 1600") ~ "afternoon",
(hour >= "1600 - 1700" & hour <= "1900 - 2000") ~ "early evening",
(hour >= "2000 - 2100" & hour <= "2300 - 0000") ~ "late evening"
))
ord = ord %>%
mutate(time_of_day =
fct_relevel(time_of_day,
c("overnight", "early morning", "morning", "afternoon", "early evening", "late evening")))
ord %>%
group_by(time_of_day, hour) %>%
summarize(n=n())
ord = ord %>%
mutate(time_of_day = case_when(
(hour >= "0000 - 0100" & hour <= "0300 - 0400") ~ "overnight",
(hour >= "0400 - 0500" & hour <= "0700 - 0800") ~ "early morning",
(hour >= "0800 - 0900" & hour <= "1100 - 1200") ~ "morning",
(hour >= "1200 - 1300" & hour <= "1500 - 1600") ~ "afternoon",
(hour >= "1600 - 1700" & hour <= "1900 - 2000") ~ "early evening",
(hour >= "2000 - 2100" & hour <= "2300 - 0000") ~ "late evening"
))
ord = ord %>%
mutate(time_of_day =
fct_relevel(time_of_day,
c("overnight", "early morning", "morning", "afternoon", "early evening", "late evening")))
total_flights = ord %>%
group_by(time_of_day) %>%
summarize(total_flights = sum(flights))
total_flights
ggplot(total_flights, aes(x=time_of_day, y=total_flights)) +
geom_col() +
xlab("Time of Day") +
ylab("Total flights") +
ggtitle("The total number of flights in different times of days")
prob5 = ord %>%
group_by(day, month, year) %>%
summarize(daily_total = sum(s))
prob5 = ord %>%
group_by(day, month, year) %>%
summarize(daily_total = sum(flights))
## data summary
prob5 = prob5 %>%
group_by(month, year) %>%
summarize(days = n(), total_month = sum(daily_total), average = total_month / days) %>%
arrange(month)
## plot the table
ggplot(prob5, aes(y=average, x=factor(month, levels =c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")))) +
geom_col() +
facet_wrap(vars(year)) +
scale_y_continuous(label = scales::comma) +
xlab("Month") +
ylab("Daily Average")
prob5 = ord %>%
group_by(day, month, year) %>%
summarize(daily_total = sum(passengers))
## data summary
prob5 = prob5 %>%
group_by(month, year) %>%
summarize(days = n(), total_month = sum(daily_total), average = total_month / days) %>%
arrange(month)
## plot the table
ggplot(prob5, aes(y=average, x=factor(month, levels =c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")))) +
geom_col() +
facet_wrap(vars(year)) +
scale_y_continuous(label = scales::comma) +
xlab("Month") +
ylab("Daily Average")
prob5 = ord %>%
group_by(day, month, year) %>%
summarize(daily_total = sum(passengers))
## data summary
prob5 = prob5 %>%
group_by(month, year) %>%
summarize(days = n(), total_month = sum(daily_total), average = total_month / days) %>%
arrange(month)
## plot the table
ggplot(prob5, aes(y=average, x=factor(month, levels =c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")))) +
geom_col() +
facet_wrap(vars(year)) +
scale_y_continuous(label = scales::comma) +
xlab("Month") +
ylab("Daily Average") +
ggtitle("Daily average for every month by years through 2017 - 2021")
prob6 = ord %>%
filter(year>=2017 & year<=2019) %>%
group_by(date, wday) %>%
summarize(total = sum(s)) %>%
group_by(wday) %>%
summarize(n=n(), total = sum(total), average = total/n) %>%
arrange(desc(average))
prob6 = ord %>%
filter(year>=2017 & year<=2019) %>%
group_by(date, wday) %>%
summarize(total = sum(passengers)) %>%
group_by(wday) %>%
summarize(n=n(), total = sum(total), average = total/n) %>%
arrange(desc(average))
prob6
highest_dates = ord_modified %>%
group_by(date) %>%
summarize(total = sum(passengers)) %>%
arrange(desc(total)) %>%
head(20)
highest_dates %>%
mutate(date = ymd(date), weekday = wday(date, label=TRUE))
highest_dates = ord %>%
group_by(date) %>%
summarize(total = sum(passengers)) %>%
arrange(desc(total)) %>%
head(20)
highest_dates %>%
mutate(date = ymd(date), weekday = wday(date, label=TRUE))
