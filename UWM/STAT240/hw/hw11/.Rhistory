knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(dplyr)
co2 = read.csv("annual-co2-emissions-per-country.csv")
sea_level = read.csv("Global_sea_level_rise.csv")
dugong_s = dugong %>%
summarise(y_s = mean(residual)) %>%
pull(y_s)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE, message=FALSE, fig.height = 4)
library(tidyverse)
library(lubridate)
library(scales)
library(modelr)
source("../../scripts/viridis.R")
dugong_s = dugong %>%
summarise(y_s = mean(residual)) %>%
pull(y_s)
getwd()
setwd("../../hw11")
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE, message=FALSE, fig.height = 4)
library(tidyverse)
library(lubridate)
library(scales)
library(modelr)
source("../../scripts/viridis.R")
source("../../scripts/ggprob.R")
# Chunk 2
dugong = read.csv("../../data/dugong.csv")
ggplot(dugong, aes(x=Length, y=Age)) +
geom_point() +
xlab("Length of dugong") +
ylab("Age of dugong") +
ggtitle("Age vs Length of dugong") +
geom_smooth(method="lm")
# Chunk 3
age_bar = mean(dugong$Age)
age_bar
age_sd = sd(dugong$Age)
age_sd
len_bar = mean(dugong$Length)
len_bar
len_sd = sd(dugong$Length)
len_sd
dugong_corr = dugong %>%
mutate(x_hat = (Length - len_bar)/len_sd, y_hat = (Age - age_bar)/age_sd, r_hat = x_hat * y_hat) %>%
summarize(r_r = sum(r_hat) / (n() - 1)) %>%
pull(r_r)
dugong_corr
slope = dugong_corr * (age_sd/len_sd)
slope
intercept = age_bar - (slope * len_bar)
intercept
# Chunk 4
df_lm = lm(Age ~ Length, data = dugong)
cf = coef(df_lm)
cf
# Chunk 5
dugong = dugong %>%
mutate(y_pred = intercept + slope * Length, residual = Age - y_pred)
ggplot(dugong, aes(x=Length, y=residual)) +
geom_point() +
geom_hline(yintercept = 0) +
xlab("Length of dugong") +
ylab("Residuals")  +
ggtitle("Residual vs Lenght of dugong")
# Chunk 6
summary(df_lm)
df_lm
# Chunk 7
sigma(df_lm)
dugong_s = dugong %>%
summarise(y_s = mean(residual)) %>%
pull(y_s)
dugong_sigma = dugong %>%
summarise(y_s = sum(residuals*residual)/(n()-2)) %>%
pull(y_s)
dugong_s = dugong %>%
summarise(y_s = mean(residual)) %>%
pull(y_s)
dugong_sigma = dugong %>%
summarise(y_s = sum(residual*residual)/(n()-2)) %>%
pull(y_s)
dugong_s
sqrt(dugong_sigma)
sigma(df_lm)
dugong_s = dugong %>%
summarise(y_s = mean(residual)) %>%
pull(y_s)
dugong_sigma = dugong %>%
summarise(y_s = sum(residual*residual)/(n()-1)) %>%
pull(y_s)
dugong_s
sqrt(dugong_sigma)
dugong_s = dugong %>%
summarise(y_s = mean(residual)) %>%
pull(y_s)
dugong_sigma = dugong %>%
summarise(y_s = sum(residual*residual)/(n()-2)) %>%
pull(y_s)
dugong_s
sqrt(dugong_sigma)
