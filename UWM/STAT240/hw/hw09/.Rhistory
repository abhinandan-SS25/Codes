knitr::opts_chunk$set(echo = TRUE, message = FALSE,
warning = FALSE, error = TRUE, fig.height = 3)
library(tidyverse)
library(kableExtra)
library(broman)
source("../../scripts/viridis.R")
source("../../scripts/ggprob.R")
theme_set(theme_minimal())
chimpanzee = read.csv("../../data/chimpanzee.csv")
View(chimpanzee)
chimpanzee = read.csv("../../data/chimpanzee.csv")
chimp_summary["partner_exists"] = chimpanzee$partner != "none"
chimpanzee = read.csv("../../data/chimpanzee.csv")
chimpanzee["partner_exists"] = chimpanzee$partner != "none"
View(chimpanzee)
chimpanzee = read.csv("../../data/chimpanzee.csv")
chimpanzee["partner_exists"] = chimpanzee$partner != "none"
chimp_summary = chimpanzee %>%
group_by(partner_exists) %>%
summarize(prosocial = sum(prosocial), selfish = sum(selfish), n = n(), p_prosocial = prosocial / n)
View(chimp_summary)
chimpanzee = read.csv("../../data/chimpanzee.csv")
chimpanzee["partner_exists"] = chimpanzee$partner != "none"
chimp_summary = chimpanzee %>%
group_by(partner_exists) %>%
summarize(prosocial = sum(prosocial), selfish = sum(selfish), n = prosocial + selfish, p_prosocial = prosocial / n)
chimpanzee = read.csv("../../data/chimpanzee.csv")
chimpanzee["partner_exists"] = chimpanzee$partner != "none"
chimp_summary = chimpanzee %>%
group_by(partner_exists) %>%
summarize(prosocial = sum(prosocial), selfish = sum(selfish), n = prosocial + selfish, p_prosocial = prosocial / n)
chimp_summary %>% print()
binom_se =  function(n, p){
return ( sqrt( p*(1-p)/n) )
}
binom_ci = function(est, se, conf=0.95){
z = qnorm(1 - (1 - conf)/2)
me = z * se
ci = est + c(-1,1)*me
return(ci)
}
n = 790
p = 0.589 - 0.461
se = binom_se(n+4, p)
ci_agresti = binom_ci(p, se)
round(ci_agresti, 3)
n1 = 610
n2 = 180
n1_1 = n1 + 2
n2_1 = n2 + 2
p1 = ((0.589 * n1) + 1)/ (n1_1 + 2)
p2 = ((0.461 * n2) + 1)/ (n2_1 + 2)
se = sqrt((p1(1-p1))/n1_1 + (p2(1-p2))/n2_1)
n1 = 610
n2 = 180
n1_1 = n1 + 2
n2_1 = n2 + 2
p1 = ((0.589 * n1) + 1)/ (n1_1 + 2)
p2 = ((0.461 * n2) + 1)/ (n2_1 + 2)
se = sqrt((p1*(1-p1))/n1_1 + (p2*(1-p2))/n2_1)
error = 1.96 * se
lower = (p1 - p2) - error
upper = (p1 - p2) + error
n1 = 610
n2 = 180
n1_1 = n1 + 2
n2_1 = n2 + 2
p1_1 = ((0.589 * n1) + 1)/ (n1_1 + 2)
p2_1 = ((0.461 * n2) + 1)/ (n2_1 + 2)
se = sqrt((p1_1*(1-p1_1))/n1_1 + (p2_1*(1-p2_1))/n2_1)
error = 1.96 * se
lower = (p1 - p2) - error
upper = (p1 - p2) + error
n1 = 610
n2 = 180
n1_1 = n1 + 2
n2_1 = n2 + 2
p1_1 = ((0.589 * n1) + 1)/ (n1_1 + 2)
p2_1 = ((0.461 * n2) + 1)/ (n2_1 + 2)
se = sqrt((p1*(1-p1))/n1_1 + (p2*(1-p2))/n2_1)
error = 1.96 * se
lower = (p1 - p2) - error
upper = (p1 - p2) + error
n1 = 610
n2 = 180
n1_1 = n1 + 2
n2_1 = n2 + 2
p1_1 = ((0.589 * n1) + 1)/ (n1_1 + 2)
p2_1 = ((0.461 * n2) + 1)/ (n2_1 + 2)
se = sqrt((p1_1*(1-p1_1))/n1_1 + (p2_1*(1-p2_1))/n2_1)
error = 1.96 * se
lower = (p1 - p2) - error
upper = (p1 - p2) + error
610 * 0.5
(610 * 0.5)(0.5)
(610 * 0.5) * (0.5)
152.2 + 305
90* 0.5 *0.5
p_60 = dbinom(359, 610, 0.5)
dbinom(359, 610, 0.5)
tibble(
x = 0:610,
prob = dbinom(x, 90, 0.5)) %>%
filter(near(prob, p_60))
tibble(
x = 0:610,
prob = dbinom(x, 610, 0.5)) %>%
filter(near(prob, p_60))
pvalue3 = pbinom(251, 610, 0.5) + (1 - pbinom(358, 610, 0.5))
pbinom(251, 610, 0.5) + (1 - pbinom(358, 610, 0.5))
p_60 = dbinom(359, 610, 0.5)
tibble(
x = 0:610,
prob = dbinom(x, 610, 0.5)) %>%
filter(near(prob, p_60))
pbinom(251, 610, 0.5) + (1 - pbinom(358, 610, 0.5))
gbinom(610, 0.5) +
geom_vline(xintercept=359, color="red",
linetype="dashed") +
geom_vline(251,  color="red",
linetype="dashed")
gbinom(610, 0.5) +
geom_vline(xintercept=359, color="red",
linetype="dashed") +
geom_vline(251,  color="red",
linetype="dashed")
gbinom(610, 0.5) +
geom_vline(xintercept=359, color="red",
linetype="dashed")
gbinom(610, 0.5) +
geom_vline(xintercept=c(359, 251), color="red",
linetype="dashed")
View(chimp_summary)
p_359 = dbinom(359, 610, 0.5)
tibble(
x = 0:359,
prob = dbinom(x, 359, 0.5)) %>%
filter(near(prob, p_359))
View(chimp_summary)
p_359 = dbinom(359, 610, 0.5)
tibble(
x = 0:359,
prob = dbinom(x, 83, 0.5)) %>%
filter(near(prob, p_359))
p_359 = dbinom(83, 180, 0.5)
tibble(
x = 0:180,
prob = dbinom(x, 83, 0.5)) %>%
filter(near(prob, p_359))
p_359 = dbinom(180, 83, 0.5)
tibble(
x = 0:180,
prob = dbinom(x, 83, 0.5)) %>%
filter(near(prob, p_359))
p_359 = dbinom(83, 180, 0.5)
tibble(
x = 0:180,
prob = dbinom(x, 180, 0.5)) %>%
filter(near(prob, p_359))
pbinom(83, 180, 0.5) + (1 - pbinom(97, 180, 0.5))
gbinom(610, 0.5, scale=TRUE) +
geom_vline(xintercept=c(359, 251), color="red",
linetype="dashed")
binom_se =  function(n, p){
return ( sqrt( p*(1-p)/n) )
}
binom_ci = function(est, se, conf=0.95){
z = qnorm(1 - (1 - conf)/2)
me = z * se
ci = est + c(-1,1)*me
return(ci)
}
n = 679
p = (326 + 2) / (n + 4)
se = binom_se(n+4, p)
ci_agresti = binom_ci(p, se)
round(ci_agresti, 3)
p_ = dbinom(29, 100, 0.5)
tibble(
x = 0:100,
prob = dbinom(x, 100, 0.5)) %>%
filter(near(prob, p_))
p_359 = dbinom(83, 180, 0.5)
tibble(
x = 0:180,
prob = dbinom(x, 180, 0.5)) %>%
filter(near(prob, p_359))
pbinom(83, 180, 0.5) + (1 - pbinom(96, 180, 0.5))
p_ = dbinom(29, 100, 0.5)
tibble(
x = 0:100,
prob = dbinom(x, 100, 0.5)) %>%
filter(near(prob, p_))
pbinom(29, 180, 0.5) + (1 - pbinom(70, 180, 0.5))
p_ = dbinom(29, 100, 0.29)
tibble(
x = 0:100,
prob = dbinom(x, 100, 0.29)) %>%
filter(near(prob, p_))
pbinom(29, 100, 0.29)
1 - pbinom(28, 100, 0.29)
n1 = 610
n2 = 180
n1_1 = n1 + 2
n2_1 = n2 + 2
p1_1 = ((0.589 * n1) + 1)/ (n1_1 + 2)
p2_1 = ((0.461 * n2) + 1)/ (n2_1 + 2)
se = sqrt((p1_1*(1-p1_1))/n1_1 + (p2_1*(1-p2_1))/n2_1)
error = 1.96 * se
lower = (p1_1 - p2_1) - error
upper = (p1_1 - p2_1) + error
