knitr::opts_chunk$set(echo = TRUE,
message=FALSE, warning = FALSE,
fig.height = 3,
error = TRUE)
library(tidyverse)
library(lubridate)
source("../../scripts/viridis.R")
knitr::opts_chunk$set(echo = TRUE,
message=FALSE, warning = FALSE,
fig.height = 3,
error = TRUE)
library(tidyverse)
library(lubridate)
source("../../scripts/viridis.R")
### Add your code here
subset <- planets %>%
group_by(method) %>%
mutate(planets_discovered=n()) %>%
filter(planets_discovered>50)
knitr::opts_chunk$set(echo = TRUE,
message=FALSE, warning = FALSE,
fig.height = 3,
error = TRUE)
library(tidyverse)
library(lubridate)
source("../../scripts/viridis.R")
knitr::opts_chunk$set(echo = TRUE,
message=FALSE, warning = FALSE,
fig.height = 3,
error = TRUE)
library(tidyverse)
library(lubridate)
source("../../scripts/viridis.R")
### Add your code here
filtered_planets = planets %>%
filter(method=="Radial Velocity") %>%
drop_na(c(year, mass)) %>%
group_by(year) %>%
mutate(planets_discovered=n(), min_mass=min(mass))
## Read in the csv file
planets = read_csv("../../data/exoplanets-clean-through-2022.csv")
co2 = read_table("../../data/co2_weekly_mlo.txt",na="-999.99",comment="#",
col_names=c("year","month","day","year.decimal","ppm","n.days","yr-1-ago","yr-10-ago","increase.1800"))
get_cwd()
get_wd()
getwd()
1 - pbinom(a_1, 50, 0.37) + dbinom(a_1, 50, 0.37)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE, message = FALSE,
warning = FALSE, error = TRUE, fig.height = 3)
library(tidyverse)
library(kableExtra)
library(broman)
source("../../scripts/viridis.R")
setwd("./hw/hw08")
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE, message = FALSE,
warning = FALSE, error = TRUE, fig.height = 3)
library(tidyverse)
library(kableExtra)
library(broman)
source("../../scripts/viridis.R")
source("../../scripts/ggprob.R")
theme_set(theme_minimal())
# Chunk 2
pnorm(qnorm(0.9, 200, 40), 200, 40) - pnorm(qnorm(0.1, 200, 40), 200, 40)
gnorm(200, 40) +
geom_norm_fill(200, 40, a = qnorm(0.9, 200, 40), b = qnorm(0.1, 200, 40))
x1 = qnorm(0.9, 200, 40)
x2 = qnorm(0.1, 200, 40)
x1
x2
# Chunk 3
p = c(0.9, 0.95, 0.975, 0.99, 0.995)
x = qnorm(p, 400, 20)
z = (x - 400)/20
df = data.frame(p, x, z)
print(df)
# Chunk 4
pnorm(250, 200, 40) - pnorm(180, 200, 40)
gnorm(200, 40) +
geom_norm_fill(200, 40, a = 250, b = 180)
# Chunk 5
qnorm(0.05, 200, 40)
gnorm(200, 40) +
geom_norm_fill(200, 40, a = qnorm(0.05, 200, 40), b = 0)
# Chunk 6
pnorm(2*39.37, 70, 3, lower.tail = FALSE)
qnorm(0.95, 70, 3)
# Chunk 7
n = 50
p = 0.37
prob5_df = tibble(
x = seq(qbinom(0.001, n, p), qbinom(0.999, n, p), 1),
prob = dbinom(x, n, p)
)
plot5 = ggplot(prob5_df, aes(x = x, y = prob)) +
geom_col(width = 1, color = "black", fill = "lightgray") +
geom_col(width = 1, color = "black", fill = "firebrick",
data = prob5_df %>% filter(x >= qbinom(0.90, n, p))) +
geom_hline(yintercept = 0) +
xlab("x") +
ylab("Probability") +
ggtitle("Binomial(50, 0.37) Distribution")
plot5
# Chunk 8
mu = 50*0.37
sigma = sqrt(50*0.37*(1-0.37))
a_1 = qbinom(0.90, 50, 0.37)
z_1 = (a_1 - mu)/sigma
a_2 = a_1 - 0.5
z_2 = (a_2 - mu)/sigma
df2 = data.frame("mu" = mu, "sigma" = sigma, "a_1" = a_1, "z_1" = z_1, "a_2" = a_2, "z_2" = z_2)
print(df2)
# Chunk 9
prob6 = prob5_df %>%
filter(x>=20)
plot6 = ggplot(prob6, aes(x = x, y = prob)) +
geom_col(width = 1, color = "black", fill = "lightgray") +
geom_col(width = 1, color = "black", fill = "firebrick",
data = prob5_df %>% filter(x >= qbinom(0.90, n, p))) +
geom_norm_fill(50*0.37, sqrt(50*0.37*(1-0.37)), a=a_1, fill = "blue", alpha = 0.5) +
geom_norm_density(50*0.37, sqrt(50*0.37*(1-0.37)), color = "blue")+
geom_hline(yintercept = 0) +
xlab("x") +
ylab("Probability") +
ggtitle("Binomial(50, 0.37) Distribution")
plot6
# Chunk 10
plot7 = ggplot(prob6, aes(x = x, y = prob)) +
geom_col(width = 1, color = "black", fill = "lightgray") +
geom_col(width = 1, color = "black", fill = "firebrick",
data = prob5_df %>% filter(x >= qbinom(0.90, n, p))) +
geom_norm_fill(50*0.37, sqrt(50*0.37*(1-0.37)), a=a_2, fill = "blue", alpha = 0.5) +
geom_norm_density(50*0.37, sqrt(50*0.37*(1-0.37)), color = "blue")+
geom_hline(yintercept = 0) +
xlab("x") +
ylab("Probability") +
ggtitle("Binomial(50, 0.37) Distribution")
plot7
1 - pbinom(a_1, 50, 0.37) + dbinom(a_1, 50, 0.37)
pnorm(a_1, 50*0.37, 50*0.37*(1-0.37), lower.tail = FALSE)
pnorm(a_2, 50*0.37, 50*0.37*(1-0.37), lower.tail = FALSE)
1 - pbinom(a_1, 50, 0.37) + dbinom(a_1, 50, 0.37)
1 - pnorm(a_1, 50*0.37, 50*0.37*(1-0.37))
1 - pnorm(a_2, 50*0.37, 50*0.37*(1-0.37))
1 - pbinom(a_1, 50, 0.37) + dbinom(a_1, 50, 0.37)
1 - pnorm(a_1, 50*0.37, sqrt(50*0.37*(1-0.37)))
1 - pnorm(a_2, 50*0.37, sqrt(50*0.37*(1-0.37)))
