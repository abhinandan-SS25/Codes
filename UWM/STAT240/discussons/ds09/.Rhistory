knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
library(tidyverse)
source("../../scripts/viridis.R")
source("../../scripts/ggprob.R")
getwd()
chimp = read.csv("../data/chimpanzee.csv")
chimp = read.csv("../../data/chimpanzee.csv")
chimp = read.csv("../../data/chimpanzee.csv")
View(chimp)
chimp = read.csv("../../data/chimpanzee.csv")
chimp %>%
drop_na(partner)
chimp = read.csv("../../data/chimpanzee.csv")
chimp %>%
filter(partner == none)
chimp = read.csv("../../data/chimpanzee.csv")
chimp %>%
filter(partner == "none")
chimp = read.csv("../../data/chimpanzee.csv")
chimp %>%
filter(partner != "none")
chimp = read.csv("../../data/chimpanzee.csv")
chimp_c = chimp %>%
filter(partner != "none") %>%
sumarize(prosocial_c = count(prosocial), selfish_c = count(selfish))
chimp = read.csv("../../data/chimpanzee.csv")
chimp_c = chimp %>%
filter(partner != "none") %>%
summarise(prosocial_c = count(prosocial), selfish_c = count(selfish))
chimp = read.csv("../../data/chimpanzee.csv")
chimp_c = chimp %>%
filter(partner != "none") %>%
summarise(prosocial_c = sum(prosocial), selfish_c = sum(selfish))
View(chimp_c)
359+251
359/610
22+16+22+18+23+19+18+19+20+19+15+16+14+14
p = (chimp_c$prosocial_c + 2) / (chimp_c$prosocial_c + chimp_c$selfish_c + 4)
binom_se =  function(n, p){
return ( sqrt( p*(1-p)/n) )
}
binom_ci = function(est, se, conf=0.95){
z = qnorm(1 - (1 - conf)/2)
me = z * se
ci = est + c(-1,1)*me
return(ci)
}
n = chimp_c$prosocial_c + chimp_c$selfish_c
p = (chimp_c$prosocial_c + 2) / (n + 4)
se = binom_se(n+4, p)
ci_agresti = binom_ci(p, se)
round(ci_agresti, 3)
